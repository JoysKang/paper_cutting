# 小学数学试卷提示词（精简版）

## 🚨 三条铁律（必须100%遵守）

### 铁律1：LaTeX公式原样保留
```
$ 12 \\div 6 = $  ✓ 保持原样
12÷6=             ✗ 不要转换
```

### 铁律2：图片全部保留
```json
{
  "imgs": ["url1", "url2", "url3"]  // 所有图片URL都要保留
}
```

### 铁律3：拆分规则（两步判断法）

**第一步：识别题型关键词（优先判断）**
以下关键词出现时，必须拆分：
- "口算" "直接写出得数" "列竖式计算" "脱式计算"
- "单位换算" "填上合适的单位"  
- "在○里填上>、<或="
- "比较大小"

**第二步：检查独立算式数量**
如果第一步没有命中关键词，再看：
- 题目中有多个**独立的**算式或等式（通常用空格或换行分隔）
- 判断标准：每个算式能否独立作为一道题？
  - ✅ 能独立 → 拆分（例如：`30分米=（ ）米    5000克=（ ）千克`）
  - ❌ 不能独立 → 不拆分（例如：`$ 12 \div 6 = $（ ），表示把（ ）平均分成（ ）份`）

**第三步：执行拆分**
```json
{
  "no": "题号",
  "prompt": "题目要求",
  "content": "",  // ⚠️ 关键：使用subqs时，content必须为空字符串""
  "subqs": [
    {"no": "x.1", "content": "第1个独立算式"},
    {"no": "x.2", "content": "第2个独立算式"},
    {"no": "x.3", "content": "第3个独立算式"}
  ]
}
```

---

## ⚠️ 拆分规则详解（重点中的重点）

### 🔍 拆分判断对比（关键）

#### ✅ 需要拆分的情况

**特征：多个独立算式，用空格或换行分隔**

```
示例1：30分米=（ ）米    5000克=（ ）千克
分析：两个独立的单位换算，中间用空格分隔 → 拆分成2个subq

示例2：$ 105 \times 4 = $    $ 3 \times 700 = $
分析：两个独立的口算题，中间用空格分隔 → 拆分成2个subq

示例3：3吨○3000千克    5米○500厘米
分析：两个独立的比较式，中间用空格分隔 → 拆分成2个subq
```

#### ❌ 不需要拆分的情况

**特征：一个完整的情景题，多个空格是连贯的**

```
示例1：$ 12 \div 6 = $（ ），可以表示把（ ）平均分成（ ）份，每份是（ ）。
分析：虽然有1个等号和多个括号，但是一个完整的情景描述 → 不拆分

示例2：小明有12个苹果，平均分给3个人，每人分（ ）个，列式为（ ）。
分析：一个完整的应用题情景 → 不拆分

示例3：观察图形，这是从（ ）面看到的，它有（ ）个面。
分析：一个完整的观察题 → 不拆分
```

---

### 场景1：单位换算题（100%拆分）

**原始题目：**
```
4. 单位换算。
   30分米=（ ）米    5000克=（ ）千克
   4000米=（ ）千米   60厘米=（ ）分米
```

**错误做法❌（绝对禁止）：**
```json
{
  "no": "4",
  "content": "30分米=（ ）米  5000克=（ ）千克  4000米=（ ）千米  60厘米=（ ）分米"
}
```

**正确做法✅（必须这样）：**
```json
{
  "no": "4",
  "prompt": "单位换算。",
  "content": "",
  "type": "填空",
  "subqs": [
    {"no": "4.1", "content": "30分米=（ ）米", "type": "填空"},
    {"no": "4.2", "content": "5000克=（ ）千克", "type": "填空"},
    {"no": "4.3", "content": "4000米=（ ）千米", "type": "填空"},
    {"no": "4.4", "content": "60厘米=（ ）分米", "type": "填空"}
  ]
}
```

### 场景2：口算题（100%拆分）

**原始题目：**
```
1. 口算。
   $ 105 \times 4 = $    $ 3 \times 700 = $
   $ 240 \div 6 = $      $ 50 + 80 = $
```

**正确做法✅：**
```json
{
  "no": "1",
  "prompt": "口算。",
  "content": "",
  "subqs": [
    {"no": "1.1", "content": "$ 105 \\times 4 = $"},
    {"no": "1.2", "content": "$ 3 \\times 700 = $"},
    {"no": "1.3", "content": "$ 240 \\div 6 = $"},
    {"no": "1.4", "content": "$ 50 + 80 = $"}
  ]
}
```

### 场景3：比较大小（100%拆分）

**原始题目：**
```
2. 在○里填上>、<或=。
   3吨○3000千克    5米○500厘米
```

**正确做法✅：**
```json
{
  "no": "2",
  "prompt": "在○里填上>、<或=。",
  "content": "",
  "subqs": [
    {"no": "2.1", "content": "3吨○3000千克"},
    {"no": "2.2", "content": "5米○500厘米"}
  ]
}
```

---

## 数学题型快速识别与处理

### 🔴 必须拆分的题型（优先级最高）

#### 1. 口算题/计算题
**识别关键词：** "口算" "直接写出得数" "列竖式计算" "脱式计算"

**处理方式：**
```json
{
  "no": "1",
  "prompt": "口算。",
  "content": "",  // 必须为空
  "subqs": [
    {"no": "1.1", "content": "$ 105 \\times 4 = $"},
    {"no": "1.2", "content": "$ 3 \\times 700 = $"}
  ]
}
```

#### 2. 单位换算题
**识别关键词：** "单位换算" "填上合适的单位" 或包含单位（米、克、吨等）的等式

**处理方式：**
```json
{
  "no": "4",
  "prompt": "单位换算。",
  "content": "",  // 必须为空
  "type": "填空",
  "subqs": [
    {"no": "4.1", "content": "30分米=（ ）米", "type": "填空"},
    {"no": "4.2", "content": "5000克=（ ）千克", "type": "填空"},
    {"no": "4.3", "content": "4000米=（ ）千米", "type": "填空"},
    {"no": "4.4", "content": "60厘米=（ ）分米", "type": "填空"},
    {"no": "4.5", "content": "120毫米=（ ）厘米", "type": "填空"},
    {"no": "4.6", "content": "2吨=（ ）千克", "type": "填空"},
    {"no": "4.7", "content": "350厘米=（ ）米（ ）分米", "type": "填空"},
    {"no": "4.8", "content": "4050克=（ ）千克（ ）克", "type": "填空"}
  ]
}
```

#### 3. 比较大小题
**识别关键词：** "在○里填上>、<或=" "比较大小"

**处理方式：**
```json
{
  "no": "2",
  "prompt": "在○里填上>、<或=。",
  "content": "",  // 必须为空
  "subqs": [
    {"no": "2.1", "content": "3吨○3000千克"},
    {"no": "2.2", "content": "5米○500厘米"}
  ]
}
```

---

### 🟡 按情况拆分的题型
**并列填空 → 拆分：**
```json
{
  "prompt": "单位换算/在○里填符号",
  "subqs": [
    {"no": "1.1", "content": "30分米=（ ）米"},
    {"no": "1.2", "content": "5000克=（ ）千克"}
  ]
}
```

**完整情景 → 不拆：**
```json
{
  "content": "$ 12 \\div 6 = $（ ），可以表示把（ ）平均分成（ ）份。"
}
```

### 应用题（看问题数）
**1个问题 → 不拆**
**多个问题 → 拆分**
```json
{
  "content": "背景描述...",
  "imgs": ["情景图.png"],
  "subqs": [
    {"no": "1.1", "prompt": "(1)问题1？"},
    {"no": "1.2", "prompt": "(2)问题2？"}
  ]
}
```

### 选择题（用opts）
```json
{
  "opts": [
    {"id": "A", "txt": "选项A", "img": ""},
    {"id": "B", "txt": "选项B", "img": ""}
  ]
}
```

---

## 图片处理规则

### 图片嵌入文字中
```json
{
  "content": "[img:0]把这些苹果平均分给2个小朋友...",
  "imgs": ["苹果.png"]
}
```

### 独立配图
```json
{
  "content": "根据上图，计算长方形面积。",
  "imgs": ["长方形.png"]
}
```

### 多张图片
```json
{
  "imgs": ["图1.png", "图2.png", "图3.png", "图4.png"]
}
```

---

## 说明文字/趣味引导

### 大题说明
```json
{
  "no": "三",
  "title": "知识之窗",
  "desc": "亲爱的同学们，校园里文化体验周开始啦！...",
  "qs": [...]
}
```

### 题目提示
```json
{
  "no": "1",
  "content": "题目内容...",
  "desc": "温馨提示：注意观察..."
}
```

---

## 输出前强制检查清单

### ✓ 第一关：拆分检查（最重要）
**逐题检查，发现以下情况必须拆分：**
- [ ] 题目中有 ≥2 个等号 → 拆成 subqs
- [ ] 题目包含"口算""单位换算""比较大小" → 拆成 subqs  
- [ ] 题目包含"列竖式""脱式计算" → 拆成 subqs
- [ ] content 中出现多个独立算式 → 拆成 subqs

**拆分后必须满足：**
- [ ] 每个 subq 只包含一个等号或一个算式
- [ ] 父题目的 content 字段为空字符串 `""`
- [ ] subqs 数组中每个元素都有 no 和 content

### ✓ 第二关：信息完整
- [ ] 所有题目都有
- [ ] 所有图片URL都在 imgs 数组中
- [ ] 趣味引导文字放在 desc 字段
- [ ] LaTeX公式原样保留（`$ ... $`）

### ✓ 第三关：格式规范
- [ ] JSON语法正确
- [ ] 字段名拼写正确
- [ ] 逗号、引号、括号配对
- [ ] 选择题使用 opts 不是 subqs

---

## 常见错误与纠正

| 错误类型 | 错误示例 | 正确做法 |
|---------|---------|---------|
| **未拆分单位换算** | `"content": "30分米=（ ）米  5000克=（ ）千克"` | 拆成2个subq，每个包含1个等号 |
| **未拆分口算题** | `"content": "$ 105 \\times 4 = $  $ 3 \\times 700 = $"` | 拆成2个subq，每个包含1个算式 |
| **content未清空** | `"content": "单位换算", "subqs": [...]` | `"content": "", "subqs": [...]` |
| **图片丢失** | `"imgs": []` | 检查原题，把所有图片URL加入数组 |
| **LaTeX被修改** | `"12÷6="` | 保持原样 `"$ 12 \\div 6 = $"` |
| **选择题用subqs** | `"subqs": [{"no":"A",...}]` | 改用 `"opts": [{"id":"A",...}]` |

---

## 完整示例（含所有要点）

```json
{
  "no": "三",
  "title": "知识之窗，仔细阅读思考再填空",
  "score": "19分",
  "desc": "亲爱的同学们，校园里文化体验周开始啦！在这里，我们能挑战识字关、学习看事创作、还能体验中医药知识的小秘密。",
  "qs": [
    {
      "no": "1",
      "prompt": "",
      "content": "草药展示台摆着一个正方体形状的草药标本盒，在下面括号内填上三张照片分别是在牛奶盒的哪个方向拍的。（填"前""上"或"右"）",
      "type": "填空",
      "score": "1分",
      "imgs": [
        "https://...标本盒.png",
        "https://...照片1.png",
        "https://...照片2.png",
        "https://...照片3.png"
      ]
    },
    {
      "no": "2",
      "prompt": "",
      "content": "[img:0]把（ ）个苹果平均分给2个小朋友，每个小朋友分（ ）个苹果，列式为（ ）÷（ ）=（ ）。",
      "type": "填空",
      "score": "4分",
      "imgs": ["https://...苹果.png"]
    },
    {
      "no": "3",
      "prompt": "单位换算。",
      "content": "",
      "type": "填空",
      "score": "4分",
      "subqs": [
        {"no": "3.1", "content": "30分米=（ ）米", "type": "填空"},
        {"no": "3.2", "content": "5000克=（ ）千克", "type": "填空"}
      ]
    },
    {
      "no": "4",
      "prompt": "",
      "content": "下图正确的是",
      "type": "填空",
      "score": "4分",
      "opts":[{"id": "[img:0]"}, {"id": "[img:1]"}, {"id": "[img:2]"},],
      "imgs": [
        "https://...标本盒.png",
        "https://...照片1.png",
        "https://...照片2.png"
      ]
    }
  ]
}
```