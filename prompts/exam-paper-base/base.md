# 试卷结构化提示词 - 基础版（强制执行）

## 🎯 任务

将试卷OCR文本转换为标准JSON结构。

**输出规则：**
- 只输出JSON，不输出解释
- 不能丢失任何信息
- 严格遵守字段规范

---

## 🚨 强制规则

### 规则1：信息零丢失
```
必须保留：
- 所有文字（题目、说明、提示）
- 所有图片URL
- 所有选项
- 所有LaTeX公式
```

### 规则2：字段规范
```json
{
  "prompt": "题目要求/指令",      // "口算""单位换算" 等
  "content": "题目主体内容",      // 完整题目文字
  "desc": "说明/提示语",          // 趣味引导、温馨提示
  "imgs": ["图片URL"],           // 所有图片
  "opts": [{"id":"A","txt":""}], // 选择题选项
  "subqs": [...]                 // 需要拆分时使用
}
```

### 规则3：图片处理
```
题目图片 → imgs 数组
选项图片 → opts[].txt 使用 [img:索引]
图片嵌入文字 → content 中用 [img:索引]
```

---

## 📋 标准JSON结构

```json
{
  "info": {
    "title": "试卷标题",
    "subject": "学科",
    "grade": "年级",
    "semester": "学期",
    "year": "学年",
    "time": "时长",
    "score": "总分"
  },
  "sections": [
    {
      "no": "一",
      "title": "大题标题",
      "score": "分值",
      "desc": "说明文字",
      "qs": [
        {
          "no": "1",
          "prompt": "题目要求",
          "content": "题目内容",
          "desc": "提示语",
          "type": "题型",
          "score": "分值",
          "imgs": [],
          "opts": [],
          "subqs": []
        }
      ]
    }
  ]
}
```

---

## 🔄 处理流程（强制执行）

### 第1步：信息提取
```
读取原题 → 提取：题号、题目、图片、选项、分数、说明文字
```

### 第2步：信息分类
| 内容类型 | 放入字段 |
|---------|---------|
| 趣味引导、场景说明 | section.desc |
| 题目要求、指令 | question.prompt |
| 题目主体 | question.content |
| 温馨提示 | question.desc |
| 图片 | imgs |
| 选项 | opts |

### 第3步：拆分判断
```
多个独立算式/填空/问题 → subqs
选择题 → opts
单一问题 → 不拆分
```

### 第4步：检查输出
```
运行检查清单 → 通过 → 输出JSON
```

---

## ⚠️ 常见错误纠正

### 错误1：prompt 和 content 混淆

**错误：**
```json
{"prompt": "完整题目内容..."}
```

**正确：**
```json
{
  "prompt": "口算",        // 只放要求
  "content": "题目内容..."  // 放主体
}
```

---

### 错误2：说明文字丢失

**错误：**
```json
{
  "title": "知识之窗"
  // desc 字段缺失，趣味引导丢了
}
```

**正确：**
```json
{
  "title": "知识之窗",
  "desc": "亲爱的同学们，校园里文化体验周开始啦！..."
}
```

---

### 错误3：选择题用 subqs

**错误：**
```json
{
  "subqs": [
    {"no": "A", "content": "选项A"}
  ]
}
```

**正确：**
```json
{
  "opts": [
    {"id": "A", "txt": "选项A", "img": ""}
  ],
  "subqs": []
}
```

---

### 错误4：图片丢失

**错误：**
```json
{
  "imgs": []  // 原题有图但这里为空
}
```

**正确：**
```json
{
  "imgs": ["https://...图1.png", "https://...图2.png"]
}
```

---

### 错误5：选项图片处理错误

**错误：**
```json
{
  "opts": [
    {"id": "A", "txt": "", "img": ""}  // txt 为空
  ]
}
```

**正确：**
```json
{
  "imgs": ["图A.png", "图B.png"],
  "opts": [
    {"id": "A", "txt": "[img:0]", "img": ""},
    {"id": "B", "txt": "[img:1]", "img": ""}
  ]
}
```

---

## ✅ 输出前强制检查

### 信息完整性
- [ ] 所有题目都有？
- [ ] 所有图片URL都在 imgs 或 opts 中？
- [ ] 趣味引导/说明放在 desc 了？
- [ ] LaTeX公式原样保留？

### 结构正确性
- [ ] prompt 和 content 是否分开？
- [ ] 选择题是否用 opts 不是 subqs？
- [ ] 需要拆分的是否都拆了？
- [ ] opts 的 txt 是否都不为空？

### 格式规范性
- [ ] JSON 语法正确？
- [ ] 字段拼写正确？
- [ ] 逗号、引号、括号配对？

---

## 📝 字段使用说明

### prompt
- 用途：题目要求、指令语
- 示例："根据拼音写词语""口算""选择正确答案"
- 如果没有单独的要求，则为空字符串 `""`

### content
- 用途：题目主体内容
- 示例：完整段落、材料、题干
- 如果内容在 subqs 中，则为空字符串 `""`

### desc
- 用途：说明文字、提示语
- section.desc：趣味引导、闯关说明、场景描述
- question.desc：温馨提示、小贴士、注意事项
- 没有则为空字符串 `""`

### imgs
- 用途：所有图片URL
- 格式：数组 `["url1", "url2"]`
- 没有则为空数组 `[]`

### opts
- 用途：选择题选项
- 格式：`[{"id":"A","txt":"文字","img":""}]`
- 图片选项：txt 使用 `[img:索引]`
- 非选择题则为空数组 `[]`

### subqs
- 用途：需要拆分的子题
- 格式：`[{"no":"1.1","content":"..."}]`
- 不需要拆分则为空数组 `[]`

---

## 🔍 空值规范

**字符串类型：**
```json
{
  "prompt": "",
  "content": "",
  "desc": ""
}
```

**数组类型：**
```json
{
  "imgs": [],
  "opts": [],
  "subqs": []
}
```

**禁止：**
- 不要省略字段
- 不要使用 `null`
- 不要使用 `undefined`