# 试卷结构化提示词 - 基础版

## 任务目标

结合 OCR 文本，将 PDF/JPG 图片内容 转换为标准试卷 JSON 结构。

要求：
- 信息零丢失
- JSON结构稳定
- 字段完整不缺失
- 图片引用一致
- 说明文字必须保留
- 不做语义改写，只做结构整理

---

# 最高优先级规则

## 信息零丢失原则（强制）

必须保留：
- 题干全部文字
- 大题说明文字
- 趣味引导语
- 温馨提示
- 括号说明
- 所有图片URL
- 所有选项
- 所有符号与LaTeX公式

允许多放，禁止丢失。

---

# 信息分类放置规则

大题导语 / 场景说明 / 趣味引导 → section.desc  
做题要求 / 指令语 → question.prompt  
题目主体 → question.content  
提示语 / 小贴士 → question.desc  
图片 → imgs  
选项 → opts

禁止把说明性文字混入 content。

---

# 🖼 图片处理规则（强制）

## 所有图片必须进入 imgs 数组

要求：
- 不漏图
- 不丢图
- 不重复造图
- 顺序按出现顺序

---

## 图片引用规则

### 图片在题干中出现：

在 content 中使用占位符：

[img:0]
[img:1]

索引对应 imgs 顺序。

---

## 独立配图：

只放 imgs，不强制写占位符。

---

# 🔴 选择题图片选项规则（强制）

如果选项是图片：

opts.txt 不得为空，必须包含：

方式A：
{"id":"A","txt":"[img:0]"}

禁止：
{"id":"A","txt":""}

---

## 图片一致性校验（强制）

如果 imgs 非空，必须满足以下之一：

- content 中引用 [img:i]
- opts.txt 中引用 [img:i]
- 明确为独立配图题

禁止 imgs 有图但结构中没有引用点。

---

# desc 保留机制

以下内容必须进入 desc：

- 趣味引导
- 温馨提示
- 括号说明
- 小字提示
- 场景描述

desc 必须始终存在字段。

---

## 标准JSON结构（必须遵循）

```json
{
  "info": {...},
  "sections": [
    {
      "no": "一",
      "title": "大题标题",
      "score": "分值",
      "desc": "说明文字（如有）",
      "qs": [
        {
          "no": "1",
          "prompt": "题目要求（如有）",
          "content": "题目内容",
          "desc": "提示语",
          "type": "题型",
          "score": "分值",
          "imgs": ["图片URL"],
          "opts": [{"id": "A", "txt": "文字", "img": ""}],
          "subqs": [...]
        }
      ]
    }
  ]
}
```

---

## 三步处理流程

### 步骤1：收集所有信息（不遗漏）

**逐题检查，确保收集到：**
- [ ] 题号
- [ ] 题目文字（完整）
- [ ] 所有图片URL
- [ ] 所有选项
- [ ] 分数
- [ ] 说明/提示/引导语
- [ ] LaTeX公式（原样）

### 步骤2：信息分类（放对位置）

**按照这个清单填充字段：**

| 信息类型 | 放入字段 | 示例 |
|---------|---------|------|
| 趣味引导、闯关说明 | `section.desc` | "亲爱的同学们..." |
| 题目要求、引导语 | `question.prompt` | "根据拼音写词语" |
| 题目主体内容 | `question.content` | 完整段落、材料 |
| 温馨提示、小贴士 | `question.desc` | "提示：注意..." |
| 所有图片 | `imgs` 数组 | ["url1", "url2"] |
| 选项 | `opts` 数组 | [{"id":"A",...}] |
| LaTeX公式 | 原样保留 | `$ \\div $` |

**图片位置标注：**
- 图片嵌入文字中 → 用 `[img:0]`
- 独立配图 → 不用标注，只放 imgs 数组

### 步骤3：拆分判断（该拆就拆）

**必须拆分成 subqs 的情况：**
- 多个独立算式（计算题）
- 多个独立填空（并列关系）
- 多个判断语句
- 多个问句（应用题）
- 多个小题

**不拆分的情况：**
- 选择题（用 opts）
- 单一问题
- 完整情景的填空

---

## 快速检查清单（输出前必查）

**信息完整性：**
- [ ] 所有题目都有？
- [ ] 所有图片URL都在 imgs 数组中？
- [ ] 所有选项都在 opts 中？
- [ ] 趣味引导/说明文字放在 desc 了？
- [ ] LaTeX公式 `$ ... $` 原样保留？
- [ ] desc 是否存在?
- [ ] 说明文字是否丢失?
- [ ] opts 是否存在空 txt

**结构正确性：**
- [ ] prompt（要求）和 content（内容）分开了？
- [ ] 计算题/填空题/应用题该拆分的都拆了？
- [ ] 选择题用 opts 不是 subqs？
- [ ] 图片嵌入文字时用了 `[img:0]`？
- [ ] JSON 字段是否齐全
- [ ] 多小问是否拆分

**格式规范性：**
- [ ] JSON格式正确（逗号、引号）？
- [ ] 字段拼写正确？
- [ ] 数组和对象使用正确？
- [ ] 不得输出解释性文字，只输出JSON

---

## 常见错误速查

| ❌ 错误 | ✅ 正确 |
|--------|--------|
| 图片URL丢失 | 所有图片都在 imgs 数组 |
| 趣味引导丢失 | 放在 section.desc 或 question.desc |
| 把内容放 prompt | 内容→content，要求→prompt |
| LaTeX转成普通符号 | `$ \\div $` 保持不变 |
| 计算题不拆分 | 每个算式一个 subq |
| 选择题用 subqs | 选择题用 opts |
| 独立配图用 [img:0] | 独立配图不用标注 |

---

## 字段速查表

**必填字段：**
- `no`, `type`, `score`

**选填字段（有就填，没有就空）：**
- `prompt`, `content`, `desc`, `imgs`, `opts`, `subqs`

**空值写法：**
- 字符串：`""`
- 数组：`[]`